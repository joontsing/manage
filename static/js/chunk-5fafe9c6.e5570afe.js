(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5fafe9c6"],{"14c3":function(e,r,t){var i=t("c6b6"),a=t("9263");e.exports=function(e,r){var t=e.exec;if("function"===typeof t){var o=t.call(e,r);if("object"!==typeof o)throw TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==i(e))throw TypeError("RegExp#exec called on incompatible receiver");return a.call(e,r)}},3835:function(e,r,t){"use strict";function i(e){if(Array.isArray(e))return e}t.d(r,"a",(function(){return c}));t("a4d3"),t("e01a"),t("d3b7"),t("d28b"),t("3ca3"),t("ddb0");function a(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var i,a,o,n,s=[],c=!0,l=!1;try{if(o=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;c=!1}else for(;!(c=(i=o.call(t)).done)&&(s.push(i.value),s.length!==r);c=!0);}catch(u){l=!0,a=u}finally{try{if(!c&&null!=t["return"]&&(n=t["return"](),Object(n)!==n))return}finally{if(l)throw a}}return s}}t("fb6a"),t("25f0"),t("b0c0"),t("a630"),t("ac1f"),t("00b4");function o(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,i=new Array(r);t<r;t++)i[t]=e[t];return i}function n(e,r){if(e){if("string"===typeof e)return o(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?o(e,r):void 0}}function s(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e,r){return i(e)||a(e,r)||n(e,r)||s()}},"466d":function(e,r,t){"use strict";var i=t("d784"),a=t("825a"),o=t("50c4"),n=t("1d80"),s=t("8aa5"),c=t("14c3");i("match",1,(function(e,r,t){return[function(r){var t=n(this),i=void 0==r?void 0:r[e];return void 0!==i?i.call(r,t):new RegExp(r)[e](String(t))},function(e){var i=t(r,e,this);if(i.done)return i.value;var n=a(e),l=String(this);if(!n.global)return c(n,l);var u=n.unicode;n.lastIndex=0;var d,p=[],h=0;while(null!==(d=c(n,l))){var m=String(d[0]);p[h]=m,""===m&&(n.lastIndex=s(l,o(n.lastIndex),u)),h++}return 0===h?null:p}]}))},"4df4":function(e,r,t){"use strict";var i=t("0366"),a=t("7b0b"),o=t("9bdd"),n=t("e95a"),s=t("50c4"),c=t("8418"),l=t("35a1");e.exports=function(e){var r,t,u,d,p,h,m=a(e),f="function"==typeof this?this:Array,_=arguments.length,b=_>1?arguments[1]:void 0,g=void 0!==b,v=l(m),P=0;if(g&&(b=i(b,_>2?arguments[2]:void 0,2)),void 0==v||f==Array&&n(v))for(r=s(m.length),t=new f(r);r>P;P++)h=g?b(m[P],P):m[P],c(t,P,h);else for(d=v.call(m),p=d.next,t=new f;!(u=p.call(d)).done;P++)h=g?o(d,b,[u.value,P],!0):u.value,c(t,P,h);return t.length=P,t}},"4e76":function(e,r,t){},"7a84":function(e,r,t){"use strict";t.d(r,"e",(function(){return o})),t.d(r,"d",(function(){return n})),t.d(r,"a",(function(){return s})),t.d(r,"b",(function(){return c})),t.d(r,"f",(function(){return l})),t.d(r,"c",(function(){return u}));t("d3b7"),t("e9c4");var i=t("b775"),a=t("5f87");function o(e){return Object(i["a"])({url:"/my/shopGetPrinter",method:"get",params:{token:Object(a["a"])(),device_id:e}})}function n(e){return Object(i["a"])({url:"/my/getPrinterInfo",method:"get",params:{token:Object(a["a"])(),printer_id:e}})}function s(e){var r=["bw_single_price","bw_double_price","color_single_price","color_double_price"];return r.forEach((function(r){e[r]&&(e[r]=JSON.stringify(e[r]))})),Object(i["a"])({url:"/my/shopAddPrinter",method:"post",params:{token:Object(a["a"])()},data:e})}function c(e){return Object(i["a"])({url:"/my/shopDeletePrinter",method:"post",params:{token:Object(a["a"])()},data:e})}function l(e){var r=["bw_single_price","bw_double_price","color_single_price","color_double_price"];return r.forEach((function(r){e[r]&&(e[r]=JSON.stringify(e[r]))})),Object(i["a"])({url:"/my/shopUpdataPrinter",method:"post",params:{token:Object(a["a"])()},data:e})}function u(e){return Object(i["a"])({url:"/my/getQRCode",method:"post",params:{token:Object(a["a"])()},data:e})}},"8aa5":function(e,r,t){"use strict";var i=t("6547").charAt;e.exports=function(e,r,t){return r+(t?i(e,r).length:1)}},a630:function(e,r,t){var i=t("23e7"),a=t("4df4"),o=t("1c7e"),n=!o((function(e){Array.from(e)}));i({target:"Array",stat:!0,forced:n},{from:a})},b433:function(e,r,t){"use strict";t("4e76")},d784:function(e,r,t){"use strict";t("ac1f");var i=t("6eeb"),a=t("d039"),o=t("b622"),n=t("9263"),s=t("9112"),c=o("species"),l=!a((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),u=function(){return"$0"==="a".replace(/./,"$0")}(),d=o("replace"),p=function(){return!!/./[d]&&""===/./[d]("a","$0")}(),h=!a((function(){var e=/(?:)/,r=e.exec;e.exec=function(){return r.apply(this,arguments)};var t="ab".split(e);return 2!==t.length||"a"!==t[0]||"b"!==t[1]}));e.exports=function(e,r,t,d){var m=o(e),f=!a((function(){var r={};return r[m]=function(){return 7},7!=""[e](r)})),_=f&&!a((function(){var r=!1,t=/a/;return"split"===e&&(t={},t.constructor={},t.constructor[c]=function(){return t},t.flags="",t[m]=/./[m]),t.exec=function(){return r=!0,null},t[m](""),!r}));if(!f||!_||"replace"===e&&(!l||!u||p)||"split"===e&&!h){var b=/./[m],g=t(m,""[e],(function(e,r,t,i,a){return r.exec===n?f&&!a?{done:!0,value:b.call(r,t,i)}:{done:!0,value:e.call(t,r,i)}:{done:!1}}),{REPLACE_KEEPS_$0:u,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:p}),v=g[0],P=g[1];i(String.prototype,e,v),i(RegExp.prototype,m,2==r?function(e,r){return P.call(e,this,r)}:function(e){return P.call(e,this)})}d&&s(RegExp.prototype[m],"sham",!0)}},dd7b:function(e,r,t){"use strict";t.r(r);var i=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"app-container"},[t("el-form",{ref:"addPrinterForm",attrs:{model:e.addPrinterForm,rules:e.rules,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"打印机名称",prop:"printer_name"}},[t("el-input",{attrs:{placeholder:"请输入打印机名称"},model:{value:e.addPrinterForm.printer_name,callback:function(r){e.$set(e.addPrinterForm,"printer_name",r)},expression:"addPrinterForm.printer_name"}})],1),t("el-form-item",{attrs:{label:"剩余纸张数",prop:"paper_num"}},[t("el-input",{attrs:{placeholder:"请输入剩余纸张数"},model:{value:e.addPrinterForm.paper_num,callback:function(r){e.$set(e.addPrinterForm,"paper_num",r)},expression:"addPrinterForm.paper_num"}})],1),t("el-form-item",{attrs:{label:"纸张大小",prop:"paper_format"}},[t("el-select",{staticClass:"paper-size-select",attrs:{placeholder:"请选择纸张大小"},model:{value:e.addPrinterForm.paper_format,callback:function(r){e.$set(e.addPrinterForm,"paper_format",r)},expression:"addPrinterForm.paper_format"}},[t("el-option",{attrs:{label:"A4",value:"A4"}}),t("el-option",{attrs:{label:"A5",value:"A5"}}),t("el-option",{attrs:{label:"Letter",value:"Letter"}})],1)],1),t("el-form-item",{attrs:{label:"打印机颜色",prop:"color_mode"}},[t("el-select",{staticClass:"paper-size-select",attrs:{placeholder:"请选择打印颜色"},model:{value:e.addPrinterForm.color_mode,callback:function(r){e.$set(e.addPrinterForm,"color_mode",r)},expression:"addPrinterForm.color_mode"}},[t("el-option",{attrs:{label:"黑白",value:0}}),t("el-option",{attrs:{label:"彩色",value:1}}),t("el-option",{attrs:{label:"黑白/彩色",value:2}})],1)],1),t("el-form-item",{attrs:{label:"打印机状态",prop:"printer_state"}},[t("el-radio-group",{model:{value:e.addPrinterForm.printer_state,callback:function(r){e.$set(e.addPrinterForm,"printer_state",r)},expression:"addPrinterForm.printer_state"}},[t("el-radio",{attrs:{label:0}},[e._v("在线")]),t("el-radio",{attrs:{label:1}},[e._v("离线")])],1)],1),t("el-form-item",{attrs:{label:"自动双面打印",prop:"auto_duplex"}},[t("el-radio-group",{model:{value:e.addPrinterForm.auto_duplex,callback:function(r){e.$set(e.addPrinterForm,"auto_duplex",r)},expression:"addPrinterForm.auto_duplex"}},[t("el-radio",{attrs:{label:1}},[e._v("是")]),t("el-radio",{attrs:{label:0}},[e._v("否")])],1)],1),e.showPrice1?t("el-form-item",{attrs:{label:"黑白单面价格",prop:"bw_single_price"}},[e._l(e.addPrinterForm.bw_single_price,(function(r){return t("span",{key:r.value},[e._v(e._s(r.range)+"页："+e._s(r.value)+"元，")])})),t("el-button",{staticStyle:{"margin-left":"30px"},attrs:{size:"small",icon:"el-icon-edit"},on:{click:function(r){return e.openDialog(1)}}},[e._v("编辑")])],2):e._e(),e.showPrice2?t("el-form-item",{attrs:{label:"黑白双面价格",prop:"bw_double_price"}},[e._l(e.addPrinterForm.bw_double_price,(function(r){return t("span",{key:r.value},[e._v(e._s(r.range)+"页："+e._s(r.value)+"元，")])})),t("el-button",{staticStyle:{"margin-left":"30px"},attrs:{size:"small",icon:"el-icon-edit"},on:{click:function(r){return e.openDialog(2)}}},[e._v("编辑")])],2):e._e(),e.showPrice3?t("el-form-item",{attrs:{label:"彩色单面价格",prop:"color_single_price"}},[e._l(e.addPrinterForm.color_single_price,(function(r){return t("span",{key:r.value},[e._v(e._s(r.range)+"页："+e._s(r.value)+"元，")])})),t("el-button",{staticStyle:{"margin-left":"30px"},attrs:{size:"small",icon:"el-icon-edit"},on:{click:function(r){return e.openDialog(3)}}},[e._v("编辑")])],2):e._e(),e.showPrice4?t("el-form-item",{attrs:{label:"彩色双面价格",prop:"color_double_price"}},[e._l(e.addPrinterForm.color_double_price,(function(r){return t("span",{key:r.value},[e._v(e._s(r.range)+"页："+e._s(r.value)+"元，")])})),t("el-button",{staticStyle:{"margin-left":"30px"},attrs:{size:"small",icon:"el-icon-edit"},on:{click:function(r){return e.openDialog(4)}}},[e._v("编辑")])],2):e._e(),t("el-form-item",[t("el-button",{on:{click:e.onCancel}},[e._v("返回上一页")]),t("el-button",{staticStyle:{"margin-left":"50px","margin-top":"20px"},attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("添加打印机")])],1)],1),t("el-dialog",{attrs:{title:"设置阶梯价格",visible:e.showDialog,width:"700px"},on:{"update:visible":function(r){e.showDialog=r}}},[e._l(e.prices,(function(r,i){return t("div",{key:i,staticClass:"price-item"},[t("el-input",{attrs:{placeholder:"请输入页数范围（例如：1-10）"},model:{value:r.range,callback:function(t){e.$set(r,"range",t)},expression:"price.range"}}),t("span",{staticStyle:{"margin-left":"5px"}},[e._v("页")]),t("el-input",{staticStyle:{"margin-left":"10px"},attrs:{placeholder:"请输入价格"},model:{value:r.value,callback:function(t){e.$set(r,"value",t)},expression:"price.value"}}),t("span",{staticStyle:{"margin-left":"5px"}},[e._v("元")]),t("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(r){return e.removePrice(i)}}}),t("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.addPrice}})],1)})),e.errorMessage?t("div",{staticClass:"error-message"},[e._v(e._s(e.errorMessage))]):e._e(),t("span",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"success"},on:{click:e.generateJson}},[e._v("确认")]),t("el-button",{on:{click:e.cencalDialog}},[e._v("取消")])],1)],2)],1)},a=[],o=t("3835"),n=(t("d3b7"),t("25f0"),t("b64b"),t("e9c4"),t("a434"),t("ac1f"),t("466d"),t("d81d"),t("a9e3"),t("7a84")),s={data:function(){return{showDialog:!1,addPrinterForm:{printer_name:"",device_id:"",device_name:"",paper_num:"",paper_format:"",color_mode:"",printer_state:"",auto_duplex:"",bw_single_price:[],bw_double_price:[],color_single_price:[],color_double_price:[]},rules:{printer_name:[{required:!0,message:"请输入打印机名称",trigger:"blur"}],paper_num:[{required:!0,message:"请输入剩余纸张数",trigger:"blur"}],paper_format:[{required:!0,message:"请选择纸张大小",trigger:"blur"}],color_mode:[{required:!0,message:"请选择打印颜色",trigger:"blur"}],printer_state:[{required:!0,message:"请设置打印机状态",trigger:"blur"}],auto_duplex:[{required:!0,message:"请设置打印机单双面",trigger:"blur"}],bw_single_price:[{required:!0,message:"请设置黑白单面价格",trigger:"blur"}],bw_double_price:[{required:!0,message:"请设置黑白双面价格",trigger:"blur"}],color_single_price:[{required:!0,message:"请设置彩色单面价格",trigger:"blur"}],color_double_price:[{required:!0,message:"请设置彩色双面价格",trigger:"blur"}]},showPrice1:!1,showPrice2:!1,showPrice3:!1,showPrice4:!1,prices:[],backupsPrices:[],priceDataID:"",errorMessage:""}},watch:{"addPrinterForm.color_mode":function(){this.updateShowPrice()},"addPrinterForm.auto_duplex":function(){console.log("auto_duplex 值变化为:",this.addPrinterForm.auto_duplex),this.updateShowPrice()}},created:function(){this.fetchData()},methods:{fetchData:function(){var e=this.$route.query.deviceId,r=this.$route.query.deviceName;this.addPrinterForm.device_id=parseInt(e),this.addPrinterForm.device_name=r},openDialog:function(e){this.priceDataID=e,this.showDialog=!0,0===this.prices.length&&(this.prices=[{range:"",value:""}]),1===this.priceDataID&&0!==this.addPrinterForm.bw_single_price.length&&(this.prices=this.addPrinterForm.bw_single_price),2===this.priceDataID&&0!==this.addPrinterForm.bw_double_price.length&&(this.prices=this.addPrinterForm.bw_double_price),3===this.priceDataID&&0!==this.addPrinterForm.color_single_price.length&&(this.prices=this.addPrinterForm.color_single_price),4===this.priceDataID&&0!==this.addPrinterForm.color_double_price.length&&(this.prices=this.addPrinterForm.color_double_price)},updateShowPrice:function(){if(null!==this.addPrinterForm.color_mode&&null!==this.addPrinterForm.auto_duplex){var e=this.addPrinterForm.color_mode+this.addPrinterForm.auto_duplex.toString();switch(e){case"00":this.showPrice1=!0,this.showPrice2=!1,this.showPrice3=!1,this.showPrice4=!1;break;case"01":this.showPrice1=!0,this.showPrice2=!0,this.showPrice3=!1,this.showPrice4=!1;break;case"10":this.showPrice1=!1,this.showPrice2=!1,this.showPrice3=!0,this.showPrice4=!1;break;case"11":this.showPrice1=!1,this.showPrice2=!1,this.showPrice3=!0,this.showPrice4=!0;break;case"20":this.showPrice1=!0,this.showPrice2=!1,this.showPrice3=!0,this.showPrice4=!1;break;case"21":this.showPrice1=!0,this.showPrice2=!0,this.showPrice3=!0,this.showPrice4=!0;break}}},onCancel:function(){this.$router.back()},submitForm:function(){var e=this;this.$refs.addPrinterForm.validate((function(r){if(r){console.log("表单验证通过，提交表单",e.addPrinterForm);var t=JSON.parse(JSON.stringify(e.addPrinterForm));e.$store.dispatch("printer/setPrinterList",t),Object(n["a"])(t).then((function(e){console.log(e)})),e.$router.back()}else e.$message.error("表单验证失败，请检查输入"),console.log("表单验证不通过，处理错误")}))},addPrice:function(){this.backupsPrices=JSON.parse(JSON.stringify(this.prices)),this.prices.push({range:"",value:""})},removePrice:function(e){0!==e?this.prices.splice(e,1):(this.prices[0].range="",this.prices[0].value="")},validateInput:function(){for(var e=0;e<this.prices.length;e++){var r=this.prices[e];if(0===e&&!r.range.match(/^1-\d+$/))return this.errorMessage="请输入正确的页数范围（例如：1-10）",!1;if(!r.range.match(/^\d+-\d+$/))return this.errorMessage="请输入正确的页数范围（例如：1-10）",!1;if(!r.value.match(/^\d+(\.\d{1,2})?$/))return this.errorMessage="请输入正确的价格",!1}for(var t=this.prices.map((function(e){return e.range})),i=0;i<t.length-1;i++){var a=t[i],n=t[i+1],s=a.split("-"),c=Object(o["a"])(s,2),l=c[0],u=c[1],d=n.split("-"),p=Object(o["a"])(d,2),h=p[0],m=p[1];if(Number(h)!==Number(u)+1)return this.errorMessage="页数范围必须连续",!1;if(Number(h)<=Number(l)||Number(m)<=Number(u))return this.errorMessage="页数范围必须递增",!1}return this.errorMessage="",!0},generateJson:function(){this.validateInput()&&(1===this.priceDataID&&(this.addPrinterForm.bw_single_price=this.prices),2===this.priceDataID&&(this.addPrinterForm.bw_double_price=this.prices),3===this.priceDataID&&(this.addPrinterForm.color_single_price=this.prices),4===this.priceDataID&&(this.addPrinterForm.color_double_price=this.prices),this.showDialog=!1,this.prices=[])},cencalDialog:function(){this.showDialog=!1,this.validateInput()||(console.log(this.prices),console.log(this.backupsPrices),this.prices=JSON.parse(JSON.stringify(this.backupsPrices)),1===this.priceDataID&&(this.addPrinterForm.bw_single_price=this.prices),2===this.priceDataID&&(this.addPrinterForm.bw_double_price=this.prices),3===this.priceDataID&&(this.addPrinterForm.color_single_price=this.prices),4===this.priceDataID&&(this.addPrinterForm.color_double_price=this.prices)),""===this.prices[0].range&&(1===this.priceDataID&&(this.addPrinterForm.bw_single_price=[]),2===this.priceDataID&&(this.addPrinterForm.bw_double_price=[]),3===this.priceDataID&&(this.addPrinterForm.color_single_price=[]),4===this.priceDataID&&(this.addPrinterForm.color_double_price=[]))}}},c=s,l=(t("b433"),t("2877")),u=Object(l["a"])(c,i,a,!1,null,"c7159b84",null);r["default"]=u.exports},e9c4:function(e,r,t){var i=t("23e7"),a=t("d066"),o=t("d039"),n=a("JSON","stringify"),s=/[\uD800-\uDFFF]/g,c=/^[\uD800-\uDBFF]$/,l=/^[\uDC00-\uDFFF]$/,u=function(e,r,t){var i=t.charAt(r-1),a=t.charAt(r+1);return c.test(e)&&!l.test(a)||l.test(e)&&!c.test(i)?"\\u"+e.charCodeAt(0).toString(16):e},d=o((function(){return'"\\udf06\\ud834"'!==n("\udf06\ud834")||'"\\udead"'!==n("\udead")}));n&&i({target:"JSON",stat:!0,forced:d},{stringify:function(e,r,t){var i=n.apply(null,arguments);return"string"==typeof i?i.replace(s,u):i}})}}]);